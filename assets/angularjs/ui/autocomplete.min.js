"use strict";angular.module("ui.autocomplete",[]).directive("uiAutocomplete",["$timeout","$exceptionHandler",function(b,a){var d=$.ui.autocomplete.prototype,e=d._initSource;function c(h,f){var g=new RegExp($.ui.autocomplete.escapeRegex(f),"i");return $.grep(h,function(i){return g.test($("<div>").html(i.label||i.value||i).text())})}$.extend(d,{_initSource:function(){if(this.options.html&&$.isArray(this.options.source)){this.source=function(g,f){f(c(this.options.source,g.term))}}else{e.call(this)}},_normalize:function(f){return $.map(f,function(g){if(g&&typeof g==="object"){return $.extend({label:g.label||g.value,value:g.value||g.label},g)}else{return{label:g+"",value:g}}})},_renderItemData:function(g,h){var f=h.groupLabel||h.label;if(h.groupLabel){f=$("<div>").append(f).addClass("ui-menu-group")}else{if(this.options.html){if(typeof f==="object"){f=$(f)}if(typeof f!=="object"||f.length>1||!f.is("a")){f=$("<a>").append(f)}}else{f=$("<a>").text(f)}}return $("<li>").append(f).appendTo(g).data("ui-autocomplete-item",h)},_resizeMenu:function(){var f=this;setTimeout(function(){var i=f.menu.element;var k=i.css("max-height")||0,j=Math.max(i.width("").outerWidth()+1,f.element.outerWidth()),h=f.element.height(),g=$(window).height()-f.options.outHeight-i.offset().top;g=k&&g>k?k:g;i.css({width:j,maxHeight:g})},10)}});return{require:"ngModel",link:function(g,h,t,n){var v=false,m=null,f={},p=null,k=angular.forEach,o=angular.isObject,y=angular.extend,A=g.$eval(t.uiAutocomplete),s=angular.bind(h,h.val),w=["close","destroy","disable","enable","option","search","widget"],z=["change","close","create","focus","open","response","search","select"];var x=g.$watch(t.ngModel,function(B){p=B;if(o(p)){n.$formatters.push(function(C){return C.value});n.$parsers.push(function(C){p.value=C;return p});g.$watch(t.ngModel,function(C){if(s()!==C.value){n.$viewValue=C.value;n.$render()}},true);n.$pristine=false;n.$setViewValue(p.value);n.$pristine=true}if(B){x()}});var j={open:function(B,C){v=true;m=null},close:function(B,C){v=false},select:function(B,C){m=C;b(function(){h.blur()},0)},change:function(B,D){var C=s();if(!m||!m.item||!C.indexOf(m.item.value)){C=A.options.onlySelect?"":C}else{C=m.item.value}if(C===null){n.$render()}else{if(C===""){g.$apply(function(){r()})}else{if(n.$viewValue!==C){g.$apply(function(){n.$setViewValue(C);n.$render();r(m)})}}}}};function r(B){if(o(p)){if(!n.$viewValue&&n.$viewValue!==0){q(p)}else{if(B&&B.item){B.item.label=o(B.item.label)?$("<div>").append(B.item.label).html():B.item.label;y(p,B.item)}}k(n.$viewChangeListeners,function(C){try{C()}catch(D){a(D)}})}}function u(){n.$setViewValue("");n.$render();r()}function l(){if(A.options.focusOpen&&!v){h.autocomplete("search","")}}function i(B){B=o(B)?B:{};B.disabled=B.source?B.disabled:true;B.appendTo=B.appendTo||h.parents(".ng-view")[0]||h.parents("[ng-view]")[0]||null;B.minLength=B.focusOpen?0:B.minLength;B.outHeight=B.outHeight||0;B.position=B.position||{my:"left top",at:"left bottom",collision:"flipfit"};return B}function q(B){if(o(B)){var C=/^\$/;k(B,function(F,D){var E=typeof F;if(C.test(D)){return}else{if(E==="number"){B[D]=0}else{if(E==="string"){B[D]=""}else{if(E==="boolean"){B[D]=false}else{if(o(F)){q(F)}}}}}})}}if(!o(A)){return}A.methods={};A.options=i(A.options);k(z,function(C){var B=A.options[C];B=typeof B==="function"?B:angular.noop;f[C]=function(D,E){if(j[C]){j[C](D,E)}B(D,E);if(A.events&&typeof A.events[C]==="function"){A.events[C](D,E)}}});k(w,function(B){A.methods[B]=function(){var C=[B];k(arguments,function(D){C.push(D)});return h.autocomplete.apply(h,C)}});A.methods.filter=c;A.methods.clean=u;h.on("focus",l);h.autocomplete(y({},A.options,f));A.widget=h.autocomplete("widget")}}}]);